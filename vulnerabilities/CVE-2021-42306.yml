title: Azure Active Directory information disclosure vulnerability 
slug: CVE-2021-42306
cves: CVE-2021-42306
affectedPlatforms:
  - Azure
affectedServices:
  - Azure AD applications 
  - Azure Migrate service 
  - Azure Site Recovery
  - Azure Automation
image: 
severity: high
discoveredBy:  Karl Fosaaen, netspi
disclosedAt: 2022/10/07
exploitabilityPeriod: Until 2021/11/17
knownITWExploitation: No
summary: |
     Automation Account “Run as” credentials (PFX certificates) were being stored in cleartext, in Azure Active Directory (AAD). These credentials were available to anyone with the ability to read information about App Registrations (typically most AAD users).
manualRemediation: |
    Regenerate exposed certificate
detectionMethods: null
contributer: https://github.com/0xdabbad00/
references:
  -https://msrc-blog.microsoft.com/2021/11/17/guidance-for-azure-active-directory-ad-keycredential-property-information-disclosure-in-application-and-service-principal-apis/
  -https://github.com/microsoft/aad-app-credential-tools/blob/main/azure-migrate/azure-migrate-credential-rotation-guide.md
  -https://www.netspi.com/blog/technical/cloud-penetration-testing/azure-cloud-vulnerability-credmanifest/log.microsoft.com/2022/04/28/azure-database-for-postgresql-flexible-server-privilege-escalation-and-remote-code-execution