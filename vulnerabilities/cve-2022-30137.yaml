title: FabricScape (CVE-2022-30137) - Azure Service Fabric privilege escalation
slug: CVE-2022-30137
cves:
- cve-2022-30137
affectedPlatforms:
- Azure
affectedServices:
- Azure Service Fabric
image: https://cdn.techcommunity.microsoft.com/lithium/ServiceFabric/ServiceFabric.PNG
severity: Medium
discoveredBy:
  name: Aviv Sasson
  org: Palo Alto
  domain: https://www.paloaltonetworks.com/
  twitter: null
disclosedAt: 2022/06/14
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
    A vulnerability in Service Fabric (SF) could enable a bad actor with access to a compromised container to escalate their privileges and gain control of the resource's host SF node and the entire cluster.
    Though the bug exists in both the Windows and Linux versions, it is only exploitable on Linux.
manualRemediation: |
  Users can check their current Service Fabric version by navigating to their Service Fabric cluster in the Azure console and then clicking on "Fabric upgrades".
  If the Fabric upgrade mode is configured to "Automatic", the cluster will be updated automatically to the latest secure version.
  If Fabric upgrade mode is configured to "Manual", customers must update it manually to the latest version (9.0.1035.1 or higher).
detectionMethods: Linux Service Fabric runtime < 9.0.1035.1
contributor: https://github.com/a10ns
references:
- https://msrc-blog.microsoft.com/2022/06/28/azure-service-fabric-privilege-escalation-from-containerized-workloads-on-linux/
- https://unit42.paloaltonetworks.com/fabricscape-cve-2022-30137/
