title: AWS IAM Authenticator for Kubernetes AccessKeyID Validation Bypass
slug: CVE-2022-2385
cves:
- CVE-2022-2385
affectedPlatforms:
- AWS
affectedServices:
- Elastic Kubernetes Service
image: https://7903508.fs1.hubspotusercontent-na1.net/hub/7903508/hubfs/Group%20102.png?width=1040&name=Group%20102.png
severity: high
discoveredBy:
  name: Gafnit Amiga
  org: Lightspin
  domain: lightspin.io
  twitter: https://mobile.twitter.com/gafnitav
disclosedAt: 2022/07/11
exploitabilityPeriod: null
knownITWExploitation: null
summary: |
  A security issue was discovered in aws-iam-authenticator where an allow-listed IAM identity may be able to modify their username and escalate privileges.
manualRemediation: |
  Upgrading to v0.5.9 mitigates this vulnerability.

  Prior to upgrading, this vulnerability can be mitigated by not using the {{AccessKeyID}} template value to construct usernames. 
detectionMethods: This issue affected the logged identity, and is not discernible from valid requests.
contributor: https://github.com/patricksanders
references:
- https://blog.lightspin.io/exploiting-eks-authentication-vulnerability-in-aws-iam-authenticator
- https://github.com/kubernetes-sigs/aws-iam-authenticator/issues/472
- https://aws.amazon.com/security/security-bulletins/AWS-2022-007/
