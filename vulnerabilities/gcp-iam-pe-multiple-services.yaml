title: IAM privilege escalation in multiple GCP services
slug: gcp-iam-pe-multiple-services
cves: null
affectedPlatforms:
- GCP
affectedServices:
- Composer
- Dataflow
- Dataproc
- Dataprep
- Data Fusion
image: https://media.istockphoto.com/photos/wooden-stairs-picture-id1262959028?k=20&m=1262959028&s=612x612&w=0&h=YbSf-ETGnbVAWQTrK-dlmrTz15VZRvSG_NNKKUxpBhg=
severity: High
discoveredBy:
  name: Allison Donovan, Dylan Ayrey
  org: null
  domain: https://security.love/
  twitter: null
disclosedAt: 2019/06/03
exploitabilityPeriod: Ongoing, partially fixed on June 2020
knownITWExploitation: null
summary: |
  Composer, Dataflow, Dataproc, Dataprep and Data Fusion all used the Compute Engine
  default service account by default and relied on product-level IAM permissions
  without requiring the iam.serviceAccount.actAs permission, meaning that users of
  these services could elevate their privileges. Following disclosure, GCP changed
  these services to require this permission.
manualRemediation: |
  None required
detectionMethods: null
contributer: https://github.com/0xdabbad00
references:
- https://security.love/blog/gcp/2020/11/22/lateral-movement-and-privesc-in-GCP.html
